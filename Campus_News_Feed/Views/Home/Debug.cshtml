@{
    ViewData["Title"] = "调试信息";
}

<div class="container">
    <h2>调试信息</h2>
    
    <h3>用户列表</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>邮箱</th>
                <th>注册时间</th>
                <th>最后登录</th>
                <th>管理员</th>
            </tr>
        </thead>
        <tbody>
            @if (ViewBag.Users != null && ViewBag.Users.Count > 0)
            {
                @foreach (var user in ViewBag.Users)
                {
                    <tr>
                        <td>@user.Id</td>
                        <td>@user.Email</td>
                        <td>@user.RegisteredAt</td>
                        <td>@(user.LastLoginAt != null ? user.LastLoginAt.ToString() : "从未登录")</td>
                        <td>@(user.IsAdmin ? "是" : "否")</td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="5" class="text-center">尚无用户</td>
                </tr>
            }
        </tbody>
    </table>
    
    <h3>令牌列表</h3>
    <table class="table table-striped">
        <thead>
            <tr>
                <th>ID</th>
                <th>类型</th>
                <th>值(部分)</th>
                <th>用户ID</th>
                <th>邮箱</th>
                <th>创建时间</th>
                <th>过期时间</th>
                <th>已使用</th>
            </tr>
        </thead>
        <tbody>
            @if (ViewBag.Tokens != null && ViewBag.Tokens.Count > 0)
            {
                @foreach (var token in ViewBag.Tokens)
                {
                    <tr>
                        <td>@token.Id</td>
                        <td>@token.Type</td>
                        <td>@(token.Value.Length > 8 ? token.Value.Substring(0, 8) + "..." : token.Value)</td>
                        <td>@token.UserId</td>
                        <td>@token.Email</td>
                        <td>@token.CreatedAt</td>
                        <td>@token.ExpiresAt</td>
                        <td>@(token.IsUsed ? "是" : "否")</td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="8" class="text-center">尚无令牌</td>
                </tr>
            }
        </tbody>
    </table>
</div> 